---
import Container from '@/components/ui/Container.astro';
import Layout from '@/layouts/Layout.astro';
import ProfileLayout from '@/layouts/ProfileLayout.astro';
import { ProductDetailPage } from '@/components/Admin/ProductDetailPage';
import { getUser } from '@/lib/auth-utils';

const { id } = Astro.params;
const productId = id || '';

// Get current user for auth
const currentUser = await getUser(Astro);
if (!currentUser) {
  return Astro.redirect('/admin/login');
}

if (!currentUser.emailVerified) {
  return Astro.redirect('/admin/emailVerification');
}

if (!productId) {
  return Astro.redirect('/admin/products');
}
---

<Layout>
  <ProfileLayout title="Manobal | Product Details">
    <Container width="marginy">
      <ProductDetailPage productId={productId} client:load />
    </Container>
  </ProfileLayout>
</Layout>
