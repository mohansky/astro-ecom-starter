---
import Container from '@/components/ui/Container.astro';
import Layout from '@/layouts/Layout.astro';
import ProfileLayout from '@/layouts/ProfileLayout.astro';
import { OrdersDataTable } from '@/components/Admin/OrdersDataTable';
import { getUser } from '@/lib/auth-utils';
import AdminBreadcrumbs from '@/components/Admin/AdminBreadcrumbs.astro';

const user = await getUser(Astro);

if (!user) {
  return Astro.redirect('/admin/login');
}

if (!user.emailVerified) {
  return Astro.redirect('/emailVerification');
}
---

<Layout>
  <ProfileLayout title="Order Management">
    <Container width="marginy">
      <AdminBreadcrumbs
        items={[{ label: 'Orders' }]}
        pageTitle="Order Management"
        pageDescription="View and manage customer orders"
      />
      <div class="card bg-base-100 shadow-sm w-full">
        <div class="card-body">
          <OrdersDataTable client:only="react" />
        </div>
      </div>
    </Container>
  </ProfileLayout>
</Layout>
