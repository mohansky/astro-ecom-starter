---
import Footer from "@/components/Layout/Footer.astro";
import Navbar from "@/components/Layout/Navbar.astro";
import CartSidebar from "@/components/ui/CartSidebar.astro";
import GeneralSEO from "@/components/SEO/GeneralSEO.astro";
import "@/styles/global.css";

import { getCollection } from "astro:content";

interface Props {
  title?: string;
  description?: string;
  canonical?: string;
  image?: string;
  type?: "website" | "article" | "profile";
  noindex?: boolean;
  breadcrumbs?: Array<{
    name: string;
    url: string;
  }>;
}

const {
  title,
  description,
  canonical,
  image,
  type = "website",
  noindex = false,
  breadcrumbs
} = Astro.props;

const siteData = await getCollection("siteData");
const siteInfo = siteData[0].data;
const site = siteInfo;

// Convert site data for SEO component
const seoTitle = title || site.title;
const seoDescription = description || site.description;
const seoImage = image || `${site.basepath}${site.ogImageURL}`;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />

    <GeneralSEO
      title={seoTitle}
      description={seoDescription}
      canonical={canonical}
      image={seoImage}
      type={type}
      keywords={site.keywords}
      author={site.author}
      siteName={site.name}
      noindex={noindex}
      breadcrumbs={breadcrumbs}
    />
  </head>

  <body>
 
    <Navbar links={site.links} />
      <!-- Cart Sidebar - OUTSIDE of navbar -->
    <CartSidebar />
    <slot />
    <Footer
      author={site.author}
      footnote={site.footnote}
      copyright={site.copyright}
      links={site.links} 
      contact={site.contactdetails}
      socials={site.socials}
    />
  </body>
</html>

<style>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
  }
</style>
