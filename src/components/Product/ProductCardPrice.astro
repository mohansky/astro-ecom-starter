---
import Heading from "../ui/Heading.astro";
import { getPriceInfo, formatCurrency } from "@/lib/pricing-utils";

interface Props {
  total?: number;
  mrp?: number;
  price?: number;
  discount?: number;
}

const { total, mrp, price, discount } = Astro.props;

// Get comprehensive price information using utility functions
const priceInfo = getPriceInfo({ price, mrp, discount, total });
const { finalPrice, originalPrice, discountPercent, hasDiscount, savings } = priceInfo;

// Check if discount was auto-calculated or manually set
const manualDiscount = discount || 0;
const isAutoCalculated = manualDiscount === 0 && discountPercent > 0;
---

<div class="flex flex-col">
  <div class="flex items-center gap-2">
    <Heading fontweight="normal" size="sm">
      {formatCurrency(finalPrice)}
    </Heading>
    {hasDiscount && (
      <span class="text-xs text-muted line-through">
        {formatCurrency(originalPrice)}
      </span>
    )}
  </div>
  {hasDiscount && (
    <span class="text-xs text-success font-semibold">
      {discountPercent.toFixed(0)}% OFF
    </span>
  )}
</div>
